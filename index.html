<!DOCTYPE html>
<html lang="bs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vaktija USK PRO</title>

<style>
body{
margin:0;
font-family:'Segoe UI',sans-serif;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:white;
text-align:center;
}
h1{margin-top:15px;}
#clock{font-size:55px;font-weight:900;}
#nextPrayer{font-weight:bold;margin:10px;}
select,button,input{
padding:8px;
border-radius:10px;
border:none;
margin:5px;
}
.namaz-container{
display:grid;
grid-template-columns:repeat(2,1fr);
gap:15px;
padding:15px;
}
.namaz{
background:rgba(255,255,255,0.1);
padding:15px;
border-radius:15px;
}
.highlight{background:#00c6ff;color:black;}
#adminPanel{
display:none;
background:#111;
padding:15px;
margin:10px;
border-radius:10px;
}
footer{margin-top:20px;font-weight:bold;}
</style>
</head>

<body>

<h1>üïå Vaktija USK PRO</h1>
<div id="clock"></div>
<div id="nextPrayer"></div>

<select id="citySelect" onchange="calculate()">
<option value="44.8167,15.8700">Bihaƒá</option>
<option value="44.9939,16.0067">Bosanska Krupa</option>
<option value="45.2036,15.8744">Velika Kladu≈°a</option>
<option value="44.9922,15.9833">Cazin</option>
<option value="44.8914,15.8006">Bu≈æim</option>
<option value="44.5461,16.0978">Kljuƒç</option>
<option value="44.7617,16.7108">Sanski Most</option>
<option value="44.7586,16.2183">Bosanski Petrovac</option>
</select>

<button onclick="enableNotifications()">üîî Notifikacije</button>
<button onclick="adminLogin()">‚öô Admin</button>

<div class="namaz-container" id="namazi"></div>

<div id="adminPanel">
<h3>Admin Pode≈°avanje</h3>
<div id="offsetInputs"></div>
<button onclick="saveOffsets()">üíæ Spasi</button>
</div>

<footer>by: AmelR.</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/praytimes/2.3.0/praytimes.min.js"></script>

<script>

const prayerNames={
fajr:"Sabah",
dhuhr:"Podne",
asr:"Ikindija",
maghrib:"Ak≈°am",
isha:"Jacija"
};

let offsets = JSON.parse(localStorage.getItem("offsets")) || {
fajr:0,
dhuhr:0,
asr:0,
maghrib:0,
isha:0
};

function updateClock(){
document.getElementById("clock").innerText =
new Date().toLocaleTimeString("bs-BA");
}
setInterval(updateClock,1000);
updateClock();

function enableNotifications(){
Notification.requestPermission();
}

function calculate(){

const coords=document.getElementById("citySelect").value.split(",");
const lat=parseFloat(coords[0]);
const lon=parseFloat(coords[1]);

const prayTimes=new PrayTimes("MWL");
prayTimes.adjust({asr:"Hanafi"});

const date=new Date();
const tz=-date.getTimezoneOffset()/60;

let times=prayTimes.getTimes(date,[lat,lon],tz);

let container=document.getElementById("namazi");
container.innerHTML="";

let nextText="";

for(let key in prayerNames){

let base=times[key];
let parts=base.split(":");

let d=new Date();
d.setHours(parts[0],parts[1],0);
d.setMinutes(d.getMinutes()+offsets[key]);

let finalTime=
d.getHours().toString().padStart(2,"0")+":"+
d.getMinutes().toString().padStart(2,"0");

let div=document.createElement("div");
div.className="namaz";
div.innerHTML="<h3>"+prayerNames[key]+"</h3><p>"+finalTime+"</p>";
container.appendChild(div);

if(!nextText && d>new Date()){
nextText="Sljedeƒái namaz: "+prayerNames[key]+" u "+finalTime;
div.classList.add("highlight");
}

schedule(finalTime,prayerNames[key]);
}

if(nextText==="") nextText="Sljedeƒái namaz: Sabah sutra";

document.getElementById("nextPrayer").innerText=nextText;
}

function schedule(time,name){

let parts=time.split(":");
let now=new Date();
let target=new Date();
target.setHours(parts[0],parts[1],0);

let diff=target-now-(5*60000);
if(diff<0) return;

setTimeout(()=>{
if(Notification.permission==="granted"){
new Notification("üïå Vrijeme je za "+name);
}
new Audio("https://www.soundjay.com/button/beep-07.mp3").play();
},diff);
}

function adminLogin(){
let pass=prompt("Unesi admin ≈°ifru:");
if(pass==="1234"){ // promijeni ≈°ifru ovdje
document.getElementById("adminPanel").style.display="block";
generateAdmin();
}
}

function generateAdmin(){
let html="";
for(let key in prayerNames){
html+=prayerNames[key]+" pomak (min): ";
html+="<input type='number' id='off_"+key+"' value='"+offsets[key]+"'><br>";
}
document.getElementById("offsetInputs").innerHTML=html;
}

function saveOffsets(){
for(let key in prayerNames){
offsets[key]=parseInt(document.getElementById("off_"+key).value)||0;
}
localStorage.setItem("offsets",JSON.stringify(offsets));
alert("Spremljeno!");
calculate();
}

calculate();

</script>

</body>
</html>
